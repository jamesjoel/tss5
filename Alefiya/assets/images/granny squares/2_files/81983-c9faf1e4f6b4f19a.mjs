(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[81983],{129291:(n,t,a)=>{a.d(t,{MH:()=>p,ad:()=>o,iN:()=>m});var e=a(7789),s=a(584992);const{Provider:i,useHook:r}=(0,s.Z)({name:"board_picker",sampleRate:e.DQ?1:.1}),o=(n,t)=>{let a="unknown";null!=t&&t.includes("pin/")?a="PinCloseup":"/"===t?a="HomeFeed":"PinBookMarklet"===t&&(a="PinBookmarklet"),null==n||n.addBinaryAnnotation("source",a,"STRING")},p=i,m=r},584992:(n,t,a)=>{a.d(t,{Z:()=>N});var e=a(667294),s=a(425288),i=a(198462),r=a(729524),o=a(860273),p=a(169213),m=a(358864),u=a(558775),c=a(505771),d=a(985271),l=a(383434),b=a(543059),y=a(453821),h=a(638089),T=a(607150),f=a(790348);const g=(0,l.X)("PwtStopwatch"),I=(n,t)=>{if(d.Z){if("start"===t.type&&!n.isTiming){const{name:a,startTime:e,navigationType:s}=t;return(0,f.A9)(`TIMING.${a}`),{isTiming:!0,name:a,isSampled:t.isSampled,startTime:"number"==typeof e?e:d.Z.now(),metricId:{type:"stopwatch",name:a,navigationType:s},pwtStaticContext:t.pwtStaticContext,annotations:n.annotations,binaryAnnotations:n.binaryAnnotations,spans:n.spans,traceId:n.traceId,spanNameUpdates:n.spanNameUpdates}}if(!n.isTiming){if(!t.bypassIsTimingCheck){const a=t.name||n.name;return g("ignoring action - stopwatch is not actively timing",t),(0,f.A9)(`WARN.${a}.noTiming.${t.type}`),n}g("allowing action while stopwatch is not actively timing (bypassIsTimingCheck is set to true)",t)}if("annotate"===t.type){const a=d.Z.now();return g(`adding annotation {${t.label}: ${a}}`),{...n,annotations:n.annotations.concat([{label:t.label,timestamp:a}])}}if("binaryAnnotate"===t.type)return g(`adding binary annotation {${t.name}: ${String(t.value)}}`),{...n,binaryAnnotations:{...n.binaryAnnotations,[t.name]:{value:t.value,type:t.annotationType}}};if("binaryAnnotateOperation"===t.type){const{value:a,type:e}=t.binaryAnnotationValueAndType;if(n.binaryAnnotations[t.name]){const s=n.binaryAnnotations[t.name].value||0;return g(`operating on binary annotation {\n          name: ${t.name}\n          pervious value: ${String(s)}\n          operand: ${String(a)}\n        }`),{...n,binaryAnnotations:{...n.binaryAnnotations,[t.name]:{value:a?t.operation(s,a):s,type:e}}}}return{...n,binaryAnnotations:{...n.binaryAnnotations,[t.name]:{value:a,type:e}}}}if("addSubspan"===t.type){g(`adding subspan {${t.name}}`);-1!==n.spans.findIndex((n=>n.name===t.name))&&g(`WARNING: adding duplicate subspan name {${t.name}}`);const a=t.id||(0,m.Z)();-1!==n.spans.findIndex((n=>n.id===a))&&g(`WARNING: adding duplicate subspan id {${t.name}: ${a}}`);let e=0;return t.startTime?e=t.startTime:n.startTime?e=n.startTime:g(`WARNING: adding subspan {${t.name}} without start time`),{...n,spans:[...n.spans,{name:t.name,id:a,startTime:e,endTime:t.endTime||1/0,annotationMap:{...t.annotations},binaryAnnotationMap:{...t.binaryAnnotations},parentId:t.parentId}]}}if("subspanStart"===t.type){var a;g(`starting subspan {${t.name}}`);-1!==n.spans.findIndex((n=>n.name===t.name))&&g(`WARNING: starting duplicate subspan name {${t.name}}`);const e=t.id||(0,m.Z)();-1!==n.spans.findIndex((n=>n.id===e))&&g(`WARNING: starting duplicate subspan id {${t.name}: ${e}}`);const s=t.parentName?null===(a=n.spans.find((n=>n.name===t.parentName)))||void 0===a?void 0:a.id:null;return{...n,spans:[...n.spans,{name:t.name,id:e,parentId:t.parentId||s,startTime:d.Z.now(),endTime:1/0,annotationMap:{...t.annotations},binaryAnnotationMap:{...t.binaryAnnotations}}]}}if("subspanStop"===t.type){if(g(`stopping subspan {${t.name}}`),!t.id){n.spans.reduce(((n,a)=>(a.name===t.name&&n.push(a),n)),[]).length>1&&(0,f.H)("duplicate_subspan_stop_name",{name:t.name,type:t.type})}const a=t.id?n.spans.findIndex((n=>n.id===t.id)):n.spans.findIndex((n=>n.name===t.name));return a>-1?(n.spans[a].endTime=d.Z.now(),t.annotations&&(n.spans[a].annotationMap={...n.spans[a].annotationMap,...t.annotations}),t.binaryAnnotations&&(n.spans[a].binaryAnnotationMap={...n.spans[a].binaryAnnotationMap,...t.binaryAnnotations})):(0,f.H)("invalid_subspan_stop_name",{name:t.name}),n}if("subspanUpdateName"===t.type){n.spans.reduce(((n,a)=>(a.name===t.currentName&&n.push(a),n)),[]).length>1&&(0,f.H)("duplicate_subspan_stop_name",{name:t.currentName,type:t.type});const a=n.spans.findIndex((n=>n.name===t.currentName));return a>-1?t.updateWhenStopwatchCompletes?n.spanNameUpdates=[...n.spanNameUpdates,{currentName:t.currentName,newName:t.newName}]:(g(`renaming subspan {${t.currentName}} to {${t.newName}}`),n.spans[a].name=t.newName):(0,f.H)("no_subspan_found_to_rename",{name:t.currentName}),n}if("stop"===t.type&&n.isTiming){const{startTime:a,metricId:e,pwtStaticContext:s,annotations:i,binaryAnnotations:p,isSampled:l,spans:f,traceId:I}=n;if(t.stopwatchPerformanceObserver&&t.stopwatchPerformanceObserver.disconnect(),l){const l=t.stopTime||d.Z.now(),A=[...f.map((t=>{t.endTime===1/0&&(t.endTime=l);const a=n.spanNameUpdates.findIndex((n=>t.name===n.currentName));return a>-1&&(g(`renaming subspan {${t.name}} to {${n.spanNameUpdates[a].newName}}`),t.name=n.spanNameUpdates[a].newName,n.spanNameUpdates=n.spanNameUpdates.filter((n=>n.newName!==t.name))),t}))];if(t.manualAndResourceSpans||0===f.length){const n=(0,m.Z)();A.push({name:"network_resources",id:n,startTime:a,endTime:l,annotationMap:{},binaryAnnotationMap:{},parentId:null},...(t.customStopwatchBuffer||[]).map((t=>(0,c.Z)((0,y.p)(t,[]),n))).filter(Boolean))}const _="initial_app_load"===e.navigationType&&(0,o.Z)(),N={type:"COMPLETE",traceId:I,startTime:a,endTime:l,spans:A,annotationMap:{...(0,r.Z)(i),...(0,T.jh)("browser_",_?(0,T.D3)(_):{}),...(0,T.jh)("mark_",(0,b.gQ)())},binaryAnnotationMap:(0,h.ng)({metricId:e,pwtStaticContext:s,binaryAnnotations:p,performanceResourceTimings:t.customStopwatchBuffer||[]})};(0,u.Z)({metricId:e,pwtStaticContext:s,result:N})}return{isTiming:!1,name:n.name,annotations:[],binaryAnnotations:{},spans:[],traceId:(0,m.Z)(),spanNameUpdates:[]}}if("error"===t.type){const{error:a,stopwatchPerformanceObserver:e}=t;return a&&(0,f.H)(a),e&&e.disconnect(),{isTiming:!1,name:n.name,annotations:[],binaryAnnotations:{},spans:[],traceId:(0,m.Z)(),spanNameUpdates:[]}}if("abort"===t.type&&n.isTiming){t.stopwatchPerformanceObserver&&t.stopwatchPerformanceObserver.disconnect();const{metricId:a,pwtStaticContext:e}=n,s=t.reason||"";return(0,u.Z)({metricId:a,pwtStaticContext:e,result:{type:"ABORT",reason:s}}),{isTiming:!1,name:n.name,annotations:[],binaryAnnotations:{},spans:[],traceId:(0,m.Z)(),spanNameUpdates:[]}}}return n},A=({name:n,sampleRate:t,navigationType:a,manualAndResourceSpans:s=!1})=>{const r=(0,i.N5)(),o=(0,e.useRef)([]),u=(0,e.useRef)(null),[c,d]=(0,e.useReducer)(I,{isTiming:!1,name:n,annotations:[],binaryAnnotations:{},spans:[],traceId:(0,m.Z)(),spanNameUpdates:[]});return r?{isTiming:c.isTiming,start:e=>{if(window.PerformanceObserver){const n=1e3;o.current=[],u.current=(0,p.Z)({entryTypes:["resource"]},(t=>{o.current=o.current.concat(t.getEntries()),o.current.length>n&&(o.current=o.current.slice(-n))}))}const s={type:"start",startTime:e,name:n,navigationType:a,pwtStaticContext:r,isSampled:!t||Math.random()<t};return d(s)},stop:n=>d({type:"stop",stopTime:n,stopwatchPerformanceObserver:u.current,customStopwatchBuffer:o.current,manualAndResourceSpans:s}),error:n=>{d({type:"error",stopwatchPerformanceObserver:u.current,error:n})},abort:n=>d({type:"abort",stopwatchPerformanceObserver:u.current,customStopwatchBuffer:o.current,reason:n}),annotate:(n,t,a=!1)=>d({type:"annotate",label:n,parentId:t,bypassIsTimingCheck:a}),binaryAnnotate:(n,t,a,e,s=!1)=>d({type:"binaryAnnotate",name:n,value:t,annotationType:a,parentId:e,bypassIsTimingCheck:s}),binaryAnnotateOperation:({name:n,binaryAnnotationValueAndType:t,operation:a,parentId:e,bypassIsTimingCheck:s=!1})=>d({type:"binaryAnnotateOperation",name:n,binaryAnnotationValueAndType:t,operation:a,parentId:e,bypassIsTimingCheck:s}),addSubspan:({name:n,startTime:t,endTime:a,annotations:e={},binaryAnnotations:s={},parentId:i=null,id:r=null,bypassIsTimingCheck:o=!1})=>d({type:"addSubspan",name:n,startTime:t,endTime:a,annotations:e,binaryAnnotations:s,parentId:i,id:r,bypassIsTimingCheck:o}),subspanStart:({name:n,annotations:t={},binaryAnnotations:a={},parentId:e=null,parentName:s=null,id:i=null,bypassIsTimingCheck:r=!1})=>d({type:"subspanStart",name:n,annotations:t,binaryAnnotations:a,parentId:e,parentName:s,id:i,bypassIsTimingCheck:r}),subspanStop:({name:n,annotations:t,binaryAnnotations:a,id:e,parentId:s,bypassIsTimingCheck:i=!1})=>d({type:"subspanStop",name:n,annotations:t,binaryAnnotations:a,id:e,parentId:s,bypassIsTimingCheck:i}),subspanUpdateName:({currentName:n,newName:t,bypassIsTimingCheck:a,updateWhenStopwatchCompletes:e=!0})=>d({type:"subspanUpdateName",currentName:n,newName:t,bypassIsTimingCheck:a,updateWhenStopwatchCompletes:e}),getSpans:(n,t)=>c.spans.filter((a=>a[n]===t)),getTraceId:()=>c.traceId}:null};var _=a(785893);const N=({name:n,sampleRate:t,abortOnUnloadOrClientNavigation:a=!0,navigationType:r,manualAndResourceSpans:o=!1})=>{const{Provider:p,useMaybeHook:m}=(0,s.Z)(`Stopwatch_${n}`);return{Provider:function({children:s}){const m=A({name:n,sampleRate:t,navigationType:r,manualAndResourceSpans:o}),u=(0,i.fM)(),c=u?u.time:0,d=(0,e.useRef)(!1),l=null==m?void 0:m.isTiming,b=(0,e.useCallback)((t=>{d.current?(d.current=!1,null==m||m.abort(t)):(0,f.A9)(`WARN.${n}.noTiming.abort`)}),[m]),y=(0,e.useCallback)(((n,t)=>{null==m||m.annotate(n,t)}),[m]),h=(0,e.useCallback)(((n,t,a,e)=>{null==m||m.binaryAnnotate(n,t,a,e)}),[m]),T=(0,e.useCallback)((({name:n,binaryAnnotationValueAndType:t,operation:a,parentId:e,bypassIsTimingCheck:s})=>{null==m||m.binaryAnnotateOperation({name:n,binaryAnnotationValueAndType:t,operation:a,parentId:e,bypassIsTimingCheck:s})}),[m]),g=(0,e.useCallback)((({name:n,startTime:t,endTime:a,annotations:e,binaryAnnotations:s,parentId:i,id:r,bypassIsTimingCheck:o})=>{null==m||m.addSubspan({name:n,startTime:t,endTime:a,annotations:e,binaryAnnotations:s,parentId:i,id:r,bypassIsTimingCheck:o})}),[m]),I=(0,e.useCallback)((({name:n,annotations:t,binaryAnnotations:a,parentId:e,parentName:s,id:i,bypassIsTimingCheck:r})=>{null==m||m.subspanStart({name:n,annotations:t,binaryAnnotations:a,parentId:e,parentName:s,id:i,bypassIsTimingCheck:r})}),[m]),N=(0,e.useCallback)((({name:n,annotations:t,binaryAnnotations:a,id:e,parentId:s,bypassIsTimingCheck:i})=>{null==m||m.subspanStop({name:n,annotations:t,binaryAnnotations:a,id:e,parentId:s,bypassIsTimingCheck:i})}),[m]),v=(0,e.useCallback)((({currentName:n,newName:t,bypassIsTimingCheck:a,updateWhenStopwatchCompletes:e})=>{null==m||m.subspanUpdateName({currentName:n,newName:t,bypassIsTimingCheck:a,updateWhenStopwatchCompletes:e})}),[m]),w=(0,e.useCallback)(((n,t)=>m?m.getSpans(n,t):[]),[m]),C=(0,e.useCallback)((()=>m?m.getTraceId():0),[m]),S=(0,e.useCallback)((t=>{d.current?(d.current=!1,null==m||m.error(t)):(0,f.A9)(`WARN.${n}.noTiming.error`)}),[m]),k=(0,e.useCallback)((n=>{d.current&&(null==m||m.abort("duplicated_init_stopwatch_action")),d.current=!0,null==m||m.start(n)}),[m]),D=(0,e.useCallback)((t=>{d.current?(d.current=!1,null==m||m.stop(t)):(0,f.A9)(`WARN.${n}.noTiming.stop`)}),[m]);(0,e.useEffect)((()=>()=>{a&&b("unloadOrClientNavigation")}),[c]);const $=(0,e.useMemo)((()=>({isTiming:l,abort:b,addAnnotation:y,addBinaryAnnotation:h,binaryAnnotationOperation:T,addSubspan:g,subspanStart:I,subspanStop:N,getSpans:w,getTraceId:C,updateSubspanName:v,stop:D,error:S,start:k})),[l,b,y,h,T,g,I,N,w,C,v,D,S,k]);return(0,_.jsx)(p,{value:$,children:s})},useHook:m}}},729524:(n,t,a)=>{a.d(t,{Z:()=>e});const e=n=>{let t={};n.forEach((({label:n,timestamp:a})=>{t={...t,[n]:(t[n]||[]).concat([a])}}));let a=Object.freeze({});return Object.keys(t).forEach((n=>{(t[n]||[]).forEach(((t,e)=>{const s=e?`${n}_${e+1}`:n;a={...a,[s]:t}}))})),a}},254469:(n,t,a)=>{a.d(t,{Z:()=>m});var e=a(667294);const s=function(n,t){this.uid=n,this.item=t,this.next=null,this.prev=null},i=function(n){this._maxNumItems=n||10,this._uidToData={},this._numItems=0,this._firstData=null,this._lastData=null};i.prototype.set=function(n,t){let a=this._uidToData[n];a||(a=new s(n,t),this._uidToData[n]=a,this._numItems+=1),this._moveToFront(a),this._numItems>this._maxNumItems&&this._evict()},i.prototype.get=function(n){const t=this._uidToData[n];return t?(this._moveToFront(t),t.item):null},i.prototype.remove=function(n){const t=this._uidToData[n];t&&(delete this._uidToData[n],this._firstData===t&&(this._firstData=t.next),this._lastData===t&&(this._lastData=t.prev),t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),this._numItems-=1)},i.prototype._moveToFront=function(n){this._firstData!==n&&(this._firstData?(this._lastData===n&&(this._lastData=n.prev),n.prev&&(n.prev.next=n.next),n.next&&(n.next.prev=n.prev),this._firstData.prev=n,n.next=this._firstData,n.prev=null,this._firstData=n):(this._firstData=n,this._lastData=n))},i.prototype._evict=function(){delete this._uidToData[this._lastData.uid],this._firstData===this._lastData?(this._firstData=null,this._lastData=null):(this._lastData=this._lastData.prev,this._lastData.next=null),this._numItems-=1};const r=i;var o=a(6637);function p({resourceName:n,resourceOptions:t}){const a={...t,count:"count"in t?t.count:5},e=o.Z.create(n,a),s=new r,i=()=>{e.abort()};return async function(n,t){const a=s.get(`${t}-${n}`);if(a){const t=a.items;if(t&&t.length){i();return{hint:a.hint,items:t,term:n}}}return n.length>=0?(async(n,t)=>{var a;if(e.isCalling()){var r,o;const a=null===(r=e.options)||void 0===r?void 0:r.term,s=null===(o=e.options)||void 0===o?void 0:o.pin_scope;if(n===a&&t===s)return;i()}const{bookmarks:p,...m}=e.options||{};e.options={...m,term:n,pin_scope:t};const u=null===(a=(await e.callGet({showError:!1})).resource_response)||void 0===a?void 0:a.data,c=null==u?void 0:u.items,d=(null==u?void 0:u.hint)||{},l={hint:d,items:c};return s.set(`${t}-${n}`,l),{term:n,items:c,hint:d}})(n,t):{hint:{},items:[],term:n}}}function m({allowSearchOnMount:n=!1,resourceName:t,resourceOptions:a={},value:s}){const i=(0,e.useRef)(!1),r=(0,e.useRef)({}),[o,m]=(0,e.useState)([]),u=function({resourceName:n,resourceOptions:t}){const a=(0,e.useRef)();return a.current||(a.current=p({resourceName:n,resourceOptions:t})),a.current}({resourceName:t,resourceOptions:a}),c=a.pin_scope||"pins",d=`${c}-${s}`;return(0,e.useEffect)((()=>{(async()=>{if(null!=s&&(n||i.current))if(d in r.current)m(r.current[d]);else try{const n=await u(s,c);if(n){const{items:t}=n;r.current[d]=t,m(t)}}catch(t){if("Resource call aborted"===t)return;throw t}i.current||(i.current=!0)})()}),[s,c,d]),o}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/81983-c9faf1e4f6b4f19a.mjs.map